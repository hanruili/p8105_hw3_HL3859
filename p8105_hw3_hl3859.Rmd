---
title: "p8105_hw3_hl3859"
author: "Hanrui Li"
date: "2024-10-16"
output: github_document
---

# Problem 1

```{r}
library(tidyverse)
library(p8105.datasets)

data("ny_noaa")

ny_noaa_cleaned <- ny_noaa |>
  mutate(
    year = lubridate::year(date),
    month = lubridate::month(date),
    day = lubridate::day(date),
    tmax = as.numeric(tmax) / 10,
    tmin = as.numeric(tmin) / 10,
    prcp = as.numeric(prcp) / 10
  )

snowfall_values <- ny_noaa_cleaned |>
  count(snow) |>
  arrange(desc(n)) |>
  head(10)

print(snowfall_values)
```

The most common values for snowfall typically include 0, as most days may not experience snow, particularly in non-winter months or in locations where snowfall is rare.

```{r}
jan_jul_data <- ny_noaa_cleaned |>
  filter(month %in% c(1, 7)) |>
  group_by(id, year, month) |>
  summarize(avg_tmax = mean(tmax, na.rm = TRUE)) |>
  ungroup()

ggplot(jan_jul_data, aes(x = year, y = avg_tmax, color = factor(month))) +
  geom_line() +
  facet_wrap(~ month) +
  labs(
    title = "Average Max Temperature in January and July across Stations",
    x = "Year",
    y = "Average Max Temperature (°C)"
  )
```

There is a clear distinction between January and July temperatures, with January showing colder temperatures (often below freezing) and July exhibiting warmer temperatures (mostly above 20°C). There seems to be a slight warming trend in January temperatures over the years, which could be interpreted as part of the broader trend of global warming. This is less clear in the July data, which remains relatively stable.

January: As noted, there are some extreme cold outliers in the January panel, where the maximum temperatures drop significantly below 0°C. These outliers suggest that certain years had particularly severe cold snaps.
July: A few years have notably lower maximum temperatures, likely representing cool or anomalous summers.

## (i)

```{r}
ggplot(ny_noaa_cleaned, aes(x = tmin, y = tmax)) +
  geom_bin2d() + 
  scale_fill_viridis_c() +
  labs(
    title = "Relationship Between Max and Min Temperatures",
    x = "Minimum Temperature (°C)",
    y = "Maximum Temperature (°C)"
  )
```

## (ii)

```{r}
snowfall_dist <- ny_noaa_cleaned |>
  filter(snow > 0, snow < 100) |>
  group_by(year) |>
  summarize(avg_snow = mean(snow, na.rm = TRUE))

ggplot(snowfall_dist, aes(x = year, y = avg_snow)) +
  geom_col() +
  labs(
    title = "Average Snowfall Distribution by Year",
    x = "Year",
    y = "Average Snowfall (mm)"
  )
```


# Problem 2

```{r}
library(tidyverse)
library(ggplot2)

demographic <- read.csv("nhanes_covar.csv", skip = 4) |>
  janitor::clean_names()

accel <- read.csv("nhanes_accel.csv") |>
  janitor::clean_names()

demographic_cleaned <- demographic |>
  filter(age >= 21) |>
  drop_na()

merged <- merge(demographic_cleaned, accel, by = "seqn")
```

```{r}
gender_education_table <- merged |>
  group_by(education, sex) |>
  summarise(Count = n()) |>
  ungroup()

gender_education_table
```






